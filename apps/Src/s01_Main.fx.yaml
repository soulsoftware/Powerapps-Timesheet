s01_Main As screen:
    LoadingSpinnerColor: =RGBA(98, 100, 167, 1)
    OnVisible: |-
        =UpdateContext({
            formCollapsed: true
        })

    s01_Container1 As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Light
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Width: =Parent.Width
        ZIndex: =3

        s01_TopBar As TopBar:
            AlignInContainer: =AlignInContainer.Stretch
            Caption: ="Timesheet User Management"
            Height: =45
            LayoutMinHeight: =640
            LayoutMinWidth: =0
            ZIndex: =1

        "s01_TabList As 'Tab list'.pcfdataset":
            AlignInContainer: =AlignInContainer.Stretch
            DisplayMode: =DisplayMode.Edit
            Height: =55
            Items: |-
                =[  { text: "TS Users", view:1 }, { text: "All Users", view:2 } ]
            LayoutMinHeight: =55
            LayoutMinWidth: =280
            Width: =280
            X: =40
            Y: =40
            ZIndex: =2

            TextInput1 As pcfDataField.textualColumn:
                FieldDisplayName: ="text"
                FieldName: ="text"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =1
                ZIndex: =14

        "s01_grd_User As 'Table (Dataverse only)'.pcfdataset":
            AlignInContainer: =AlignInContainer.Stretch
            DisplayMode: =DisplayMode.Edit
            EnableRangeSelection: ='PowerAppsOneGrid.EnableRangeSelection'.Disable
            FillPortions: =1
            Height: =496
            Items: |-
                =With({
                    view: s01_TabList.Selected.view 
                },
                Switch( view, 1, Filter(Users, 'Users (Views)'.'TS Users'), 2, Filter(Users, 'Users (Views)'.'Enabled Users')))
            LayoutMinHeight: =500
            LayoutMinWidth: =If(Self.X + 800 > Parent.Width, Parent.Width - Self.X, 800)
            PCFTeamsTheme: ="default"
            ReflowBehavior: ='PowerAppsOneGrid.ReflowBehavior'.Reflow
            Width: =1366
            X: =0
            Y: =0
            ZIndex: =3

            "'Full Name1' As pcfDataField.textualColumn":
                FieldDisplayName: ="Full Name"
                FieldName: ="fullname"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =3
                ZIndex: =3

            "'Alternative Email 11' As pcfDataField.textualColumn":
                FieldDisplayName: ="Alternative Email 1"
                FieldName: ="soul_alternativeemail1"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =5
                ZIndex: =5

            "'Alternative Email 21' As pcfDataField.textualColumn":
                FieldDisplayName: ="Alternative Email 2"
                FieldName: ="soul_alternativeemail2"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =5
                ZIndex: =6

            "'Alternative Email 31' As pcfDataField.textualColumn":
                FieldDisplayName: ="Alternative Email 3"
                FieldName: ="soul_alternativeemail3"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =6
                ZIndex: =7

            "'Access Mode1' As pcfDataField.textualColumn":
                FieldDisplayName: ="Access Mode"
                FieldName: ="accessmode"
                FieldType: ="l"
                FieldVariantName: ="textualColumn"
                Order: =6
                ZIndex: =8

            "'Job Title1' As pcfDataField.textualColumn":
                FieldDisplayName: ="Job Title"
                FieldName: ="jobtitle"
                FieldType: ="s"
                FieldVariantName: ="textualColumn"
                Order: =9
                ZIndex: =9

            "'License Type1' As pcfDataField.textualColumn":
                FieldDisplayName: ="License Type"
                FieldName: ="caltype"
                FieldType: ="l"
                FieldVariantName: ="textualColumn"
                Order: =8
                ZIndex: =10

            "'Organization 1' As pcfDataField.textualColumn":
                FieldDisplayName: ="Organization "
                FieldName: ="organizationid"
                FieldType: ="g"
                FieldVariantName: ="textualColumn"
                Order: =10
                ZIndex: =11

            "'User License Type1' As pcfDataField.textualColumn":
                FieldDisplayName: ="User License Type"
                FieldName: ="userlicensetype"
                FieldType: ="n"
                FieldVariantName: ="textualColumn"
                Order: =7
                ZIndex: =12

            "'User Licensed1' As pcfDataField.textualColumn":
                FieldDisplayName: ="User Licensed"
                FieldName: ="islicensed"
                FieldType: ="l"
                FieldVariantName: ="textualColumn"
                Order: =7
                ZIndex: =13

        s01_CollapsableBar As CollapsableBar:
            AlignInContainer: =AlignInContainer.Stretch
            Caption: =s01_grd_User.Selected.'Full Name'
            Collapsed: =formCollapsed
            Height: =32
            LayoutMinHeight: =640
            LayoutMinWidth: =0
            OnAction: |-
                =UpdateContext({ formCollapsed: Collapsed })
            ZIndex: =4

        s01_Container2 As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.Light
            Height: =50
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingRight: =10
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Visible: =Not(s01_CollapsableBar.Collapsed)
            ZIndex: =5

            s01_frm_User As form:
                BorderColor: =RGBA(243, 242, 241, 1)
                DataSource: =Users
                Height: =180
                Item: =s01_grd_User.Selected
                LayoutMinHeight: =100
                LayoutMinWidth: =400
                NumberOfColumns: =4
                Width: =1366
                Y: =529
                ZIndex: =2

                Status_DataCard1 As typedDataCard.pcfCoreComboBoxOptionSetSingleEditCard:
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="isdisabled"
                    Default: =ThisItem.Status
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@Users],DataSourceInfo.DisplayName,"isdisabled")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    Required: =false
                    Update: =DataCardValue1.Selected.Value
                    Width: =341
                    WidthFit: =true
                    X: =0
                    Y: =1
                    ZIndex: =1

                    DataCardKey1 As Label:
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =22
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =10
                        ZIndex: =1

                    DataCardValue1 As combobox:
                        AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                        BorderColor: =RGBA(243, 242, 241, 1)
                        ChevronBackground: =RGBA(243, 242, 241, 1)
                        ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                        ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                        ChevronFill: =RGBA(96, 94, 92, 1)
                        ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                        ChevronHoverFill: =RGBA(96, 94, 92, 1)
                        Color: =RGBA(37, 36, 35, 1)
                        DefaultSelectedItems: =[Parent.Default]
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(200, 198, 196, 1)
                        DisabledFill: =RGBA(243, 242, 241, 1)
                        DisplayFields: =["Value"]
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(243, 242, 241, 1)
                        FocusedBorderColor: =RGBA(98, 100, 167, 1)
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                        HoverColor: =RGBA(37, 36, 35, 1)
                        HoverFill: =RGBA(243, 242, 241, 1)
                        IsSearchable: =false
                        Items: =Choices('Status (Users)')
                        PaddingLeft: =12
                        PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(243, 242, 241, 1)
                        SearchFields: =["Value"]
                        SearchItems: =[]
                        SelectionColor: =RGBA(37, 36, 35, 1)
                        SelectionFill: =RGBA(237, 235, 233, 1)
                        SelectMultiple: =false
                        Size: =10.5
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey1.Y + DataCardKey1.Height + 4
                        ZIndex: =2

                    ErrorMessage1 As Label:
                        AutoHeight: =true
                        Color: =Color.Red
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =30
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValue1.Y + DataCardValue1.Height
                        ZIndex: =3

                    StarVisible1 As Label:
                        Alignment: =Align.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =20
                        Text: ="*"
                        VerticalAlignment: =VerticalAlign.Bottom
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey1.Y
                        ZIndex: =4

                "'Alternative Email 1_DataCard1' As typedDataCard.pcfCoreTextualEditCard":
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_alternativeemail1"
                    Default: =ThisItem.'Alternative Email 1'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@Users],DataSourceInfo.DisplayName,"soul_alternativeemail1")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    MaxLength: =DataSourceInfo([@Users], DataSourceInfo.MaxLength, "soul_alternativeemail1")
                    Required: =false
                    Update: =DataCardValue5.Value
                    Width: =341
                    WidthFit: =true
                    X: =0
                    Y: =0
                    ZIndex: =3

                    DataCardKey5 As Label:
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =22
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =10
                        ZIndex: =1

                    "DataCardValue5 As 'Text box'":
                        AccessibleLabel: =Parent.DisplayName
                        DisplayMode: =Parent.DisplayMode
                        FontSize: =10.5
                        Height: =32
                        Mode: ="SingleLine"
                        Required: =Parent.Required
                        Tooltip: =Parent.DisplayName
                        Value: =Parent.Default
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey5.Y + DataCardKey5.Height + 4
                        ZIndex: =2

                    ErrorMessage4 As Label:
                        AutoHeight: =true
                        Color: =Color.Red
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =30
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValue5.Y + DataCardValue5.Height
                        ZIndex: =3

                    StarVisible4 As Label:
                        Alignment: =Align.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =30
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey5.Y
                        ZIndex: =4

                "'Alternative Email 2_DataCard1' As typedDataCard.pcfCoreTextualEditCard":
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_alternativeemail2"
                    Default: =ThisItem.'Alternative Email 2'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@Users],DataSourceInfo.DisplayName,"soul_alternativeemail2")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    MaxLength: =DataSourceInfo([@Users], DataSourceInfo.MaxLength, "soul_alternativeemail2")
                    Required: =false
                    Update: =DataCardValue6.Value
                    Width: =341
                    WidthFit: =true
                    X: =1
                    Y: =0
                    ZIndex: =3

                    DataCardKey6 As Label:
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =22
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =10
                        ZIndex: =1

                    "DataCardValue6 As 'Text box'":
                        AccessibleLabel: =Parent.DisplayName
                        DisplayMode: =Parent.DisplayMode
                        FontSize: =10.5
                        Height: =32
                        Mode: ="SingleLine"
                        Required: =Parent.Required
                        Tooltip: =Parent.DisplayName
                        Value: =Parent.Default
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey6.Y + DataCardKey6.Height + 4
                        ZIndex: =2

                    ErrorMessage5 As Label:
                        AutoHeight: =true
                        Color: =Color.Red
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =30
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValue6.Y + DataCardValue6.Height
                        ZIndex: =3

                    StarVisible5 As Label:
                        Alignment: =Align.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =30
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey6.Y
                        ZIndex: =4

                "'Alternative Email 3_DataCard1' As typedDataCard.pcfCoreTextualEditCard":
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_alternativeemail3"
                    Default: =ThisItem.'Alternative Email 3'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@Users],DataSourceInfo.DisplayName,"soul_alternativeemail3")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    MaxLength: =DataSourceInfo([@Users], DataSourceInfo.MaxLength, "soul_alternativeemail3")
                    Required: =false
                    Update: =DataCardValue7.Value
                    Width: =341
                    WidthFit: =true
                    X: =2
                    Y: =0
                    ZIndex: =3

                    DataCardKey7 As Label:
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =22
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =10
                        ZIndex: =1

                    "DataCardValue7 As 'Text box'":
                        AccessibleLabel: =Parent.DisplayName
                        DisplayMode: =Parent.DisplayMode
                        FontSize: =10.5
                        Height: =32
                        Mode: ="SingleLine"
                        Required: =Parent.Required
                        Tooltip: =Parent.DisplayName
                        Value: =Parent.Default
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey7.Y + DataCardKey7.Height + 4
                        ZIndex: =2

                    ErrorMessage6 As Label:
                        AutoHeight: =true
                        Color: =Color.Red
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =30
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValue7.Y + DataCardValue7.Height
                        ZIndex: =3

                    StarVisible6 As Label:
                        Alignment: =Align.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =30
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey7.Y
                        ZIndex: =4

            s01_btn_Submit As Button:
                AlignInContainer: =AlignInContainer.End
                Appearance: ='ButtonCanvas.Appearance'.Primary
                DisplayMode: =If(s01_frm_User.Valid, DisplayMode.Edit, DisplayMode.Disabled)
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                OnSelect: =SubmitForm(s01_frm_User)
                Text: ="Submit"
                Width: =96
                X: =0
                Y: =0
                ZIndex: =3

        s01_BottomBar As BottomBar:
            AlignInContainer: =AlignInContainer.Stretch
            Height: =28
            LayoutMinHeight: =640
            LayoutMinWidth: =0
            Version: =AppVersion
            ZIndex: =6

