"s03_Main As screen.'teamsHeroApp_ver1.0'":
    LoadingSpinnerColor: =RGBA(98, 100, 167, 1)
    OnVisible: |
        =UpdateContext( { 
            edit_mode:false, 
            delete_mode:false,
            assign_mode:false,
            recall_mode: false
        });

    s03_MainContainer As groupContainer.horizontalAutoLayoutContainer:
        Height: =Parent.Height
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        ZIndex: =1

        s03_LeftContainer As groupContainer:
            FillPortions: =0
            Height: =Parent.Height
            LayoutMinHeight: =Parent.Height
            LayoutMinWidth: =500
            Visible: =Self.Width <> 0
            Width: =Parent.Width * 0.75
            ZIndex: =1

            s03_gal_Timesheet As gallery.BrowseLayout_Vertical_TwoTextOneImageVariant_pcfCore:
                BorderColor: =RGBA(243, 242, 241, 1)
                DelayItemLoading: =true
                DisplayMode: |-
                    =If(Or(edit_mode, add_mode, delete_mode, multi_delete_mode, recall_mode, multi_recall_mode, multi_submit_mode), 
                    DisplayMode.Disabled, 
                    DisplayMode.Edit)
                FocusedBorderColor: =RGBA(98, 100, 167, 1)
                FocusedBorderThickness: =2
                Height: =Parent.Height - 2 * varStyle.topBarHeight - varStyle.bottomBarHeight
                Items: |-
                    =With({
                        MyDataSource: Filter( TSExpenses, 'TSExpenses (Views)'.'My Expenses View')
                    },
                    Filter(
                        If( sortByDate, 
                            SortByColumns(
                                MyDataSource,
                                "soul_dateofinterest",
                                SortOrder.Descending
                            ),
                            SortByColumns(
                                MyDataSource,
                                "createdon",
                                SortOrder.Descending
                            )
                        ),
                        If( Len(searchByMail) > 0,
                            StartsWith( 'Resource Email', searchByMail ),
                            true
                        ) 
                    ))
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: |
                    =With({
                        recordID: ThisItem.TSExpense
                    },
                    Trace( "select gallery: " & recordID, TraceSeverity.Information );
                    UpdateContext( { selected_item: ThisItem  } )
                    )
                TabIndex: =0
                TemplateFill: |-
                    =Switch( ThisItem.'Approval Status', 
                        'Approval Status'.Pending, RGBA(255,255,102,.7),
                        'Approval Status'.Rejected, ColorFade(Color.Orange, .5),    
                        If( 
                            And( Not( IsBlank(selected_item) ), ThisItem.IsSelected),
                            Color.WhiteSmoke,
                            Color.White
                        )
                    )
                TemplatePadding: =0
                TemplateSize: =60
                Width: =Parent.Width
                Y: =s03_ToolBar.Y + s03_ToolBar.Height
                ZIndex: =1

                s03_Container1 As groupContainer.horizontalAutoLayoutContainer:
                    Height: =Parent.TemplateHeight
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutMode: =LayoutMode.Auto
                    Width: =Parent.TemplateWidth
                    ZIndex: =1

                    s03_img_Receipt As image:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        Height: =48
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverFill: =RGBA(0, 0, 0, 0)
                        Image: =receipt
                        LayoutMinHeight: =Parent.Height
                        OnSelect: =// Select(Parent)
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =RGBA(0, 0, 0, 0)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        RadiusBottomLeft: =3
                        RadiusBottomRight: =3
                        RadiusTopLeft: =3
                        RadiusTopRight: =3
                        Width: =48
                        ZIndex: =1

                    s03_Container3 As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =Parent.Height
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =2

                        s03_Container4 As groupContainer.horizontalAutoLayoutContainer:
                            FillPortions: =0
                            Height: =Parent.Height / 2
                            LayoutMinHeight: =Parent.Height / 2
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            Width: =Parent.Width
                            X: =60
                            ZIndex: =1

                            s03_lbl_ResourceEmail As Label:
                                AlignInContainer: =AlignInContainer.Center
                                AutoHeight: =false
                                DisplayMode: =DisplayMode.Edit
                                FillPortions: =1
                                FontSize: =12
                                FontWeight: =FontWeight.Semibold
                                Height: =29
                                LayoutMinHeight: =32
                                LayoutMinWidth: =335
                                OnSelect: =//Select(Parent)
                                Overflow: ="Hidden"
                                PaddingBottom: =0
                                PaddingTop: =0
                                TabIndex: =-1
                                Text: =ThisItem.'Owning User'.'Full Name'
                                VerticalAlignment: =VerticalAlign.Top
                                Width: =335
                                X: =63
                                Y: =2
                                ZIndex: =1

                            s03_lbl_CreatedOn As Label:
                                AlignInContainer: =AlignInContainer.Center
                                Alignment: =Align.Left
                                AutoHeight: =false
                                DisplayMode: =DisplayMode.View
                                FillPortions: =1
                                Height: =Parent.Height
                                LayoutMinHeight: =32
                                LayoutMinWidth: =200
                                OnSelect: =// Select(Parent)
                                Overflow: ="Hidden"
                                PaddingBottom: =0
                                PaddingTop: =0
                                PCFTeamsTheme: ="default"
                                Text: =$"Created On {Text(ThisItem.'Created On',DateTimeFormat.ShortDateTime24)}"
                                VerticalAlignment: =VerticalAlign.Middle
                                Width: =390
                                X: =567
                                Y: =2
                                ZIndex: =2

                        s03_Container2 As groupContainer.horizontalAutoLayoutContainer:
                            FillPortions: =0
                            Height: =Parent.Height / 2
                            LayoutAlignItems: =LayoutAlignItems.End
                            LayoutMinHeight: =Parent.Height / 2
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            Width: =Parent.Width
                            X: =40
                            Y: =Parent.Height / 2
                            ZIndex: =2

                            s03_lbl_Project As Label:
                                AlignInContainer: =AlignInContainer.End
                                DisplayMode: =DisplayMode.Edit
                                FillPortions: =1
                                FontSize: =11
                                FontWeight: =FontWeight.Semibold
                                Height: =Parent.Height
                                LayoutMinHeight: =32
                                LayoutMinWidth: =200
                                OnSelect: =
                                Text: =ThisItem.Project.Name
                                Width: =200
                                X: =40
                                Y: =25
                                ZIndex: =1

                            s03_lbl_DateOfInterest As Label:
                                AutoHeight: =false
                                Color: |+
                                    =With({ 
                                        weekday: Upper(CommonUtils.GetWeekDayText(ThisItem.'Date of Interest')) 
                                    }, 
                                    Switch( weekday, "SUN", Color.OrangeRed, "SAT", Color.Orange, Color.Black)
                                    )
                                    
                                DisplayMode: =DisplayMode.View
                                FontSize: =11
                                FontWeight: =FontWeight.Semibold
                                Height: =Parent.Height
                                LayoutMinHeight: =32
                                LayoutMinWidth: =320
                                OnSelect: =// Select(Parent)
                                Overflow: ="Hidden"
                                PaddingBottom: =0
                                PaddingTop: =0
                                TabIndex: =-1
                                Text: =$"{Text(ThisItem.'Date of Interest',DateTimeFormat.ShortDate)} - {CommonUtils.GetWeekDayText(ThisItem.'Date of Interest')}"
                                VerticalAlignment: =VerticalAlign.Bottom
                                Width: =135
                                X: =s03_lbl_ResourceEmail.X
                                Y: |
                                    =0
                                ZIndex: =2

                            s06_lbl_Reason As Label:
                                AlignInContainer: =AlignInContainer.End
                                AutoHeight: =false
                                DisplayMode: =DisplayMode.Edit
                                FontSize: =11
                                FontWeight: =FontWeight.Semibold
                                Height: =Parent.Height
                                LayoutMinHeight: =32
                                LayoutMinWidth: =120
                                OnSelect: =
                                Overflow: ="Hidden"
                                PaddingBottom: =0
                                PaddingTop: =0
                                PCFTeamsTheme: ="default"
                                Text: =$"{Text( ThisItem.Amount )} {ThisItem.Currency.'Currency Symbol'} - {ThisItem.Reason}"
                                VerticalAlignment: =VerticalAlign.Bottom
                                Width: =200
                                X: =197
                                Y: =0
                                ZIndex: =3

                            s06_lbl_Status As Label:
                                AlignInContainer: =AlignInContainer.End
                                Alignment: =Align.Left
                                DisplayMode: =DisplayMode.Edit
                                FontSize: =11
                                FontWeight: =FontWeight.Semibold
                                Height: =Parent.Height
                                LayoutMinHeight: =32
                                LayoutMinWidth: =200
                                OnSelect: =
                                Text: =ThisItem.'Approval Status'
                                Width: =100
                                X: =40
                                Y: =25
                                ZIndex: =4

                    s03_Commands As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =57
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutGap: =20
                        LayoutJustifyContent: =LayoutJustifyContent.End
                        LayoutMinHeight: =Parent.Height
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =20
                        Width: =120
                        X: =
                        ZIndex: =3

                        "s03_chk_Select As 'Check box'":
                            BoxSide: ='Checkbox.BoxSide'.Start
                            Checked: =false
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: =""
                            LayoutMinHeight: =32
                            LayoutMinWidth: =160
                            OnCheck: =Collect( col_selectedItems, ThisItem)
                            OnUncheck: |
                                =Remove( col_selectedItems, ThisItem)
                            Width: =25
                            X: =0
                            Y: =0
                            ZIndex: =4

                s03_Selectable As rectangle:
                    BorderColor: =Color.Transparent
                    DisabledFill: =Color.Transparent
                    Fill: =Color.Transparent
                    FocusedBorderColor: =Color.Transparent
                    FocusedBorderThickness: =1
                    Height: =Parent.TemplateHeight
                    HoverFill: =Color.Transparent
                    OnSelect: =Select(Parent)
                    PressedFill: =Color.Transparent
                    Width: =Parent.TemplateWidth * 0.9
                    ZIndex: =2

            s03_ToolBar As groupContainer.horizontalAutoLayoutContainer:
                Height: =50
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutGap: =10
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =10
                Width: =Parent.Width
                Y: =50
                ZIndex: =2

                "s03_txt_searchByMail As 'Text box'":
                    DelayOutput: =false
                    DisplayMode: =DisplayMode.Edit
                    FontWeight: ="normal"
                    Height: =32
                    Italic: =false
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    MaxLength: =-1
                    OnChange: |-
                        =UpdateContext( { searchByMail: s03_txt_searchByMail.Value } )
                    PaddingBottom: =0
                    PaddingTop: =0
                    PCFTeamsTheme: ="default"
                    Placeholder: ="search by mail"
                    Strikethrough: =false
                    Underline: =false
                    Value: =""
                    Visible: =false
                    Width: =366
                    X: =44
                    Y: =10
                    ZIndex: =1

                s03_SortToggle As Toggle:
                    DisplayMode: =DisplayMode.Edit
                    FontWeight: ="normal"
                    Height: =32
                    Italic: =false
                    LayoutMinHeight: =32
                    LayoutMinWidth: =160
                    OffFillColor: =RGBA(255, 255, 255, 1)
                    OffText: ="Sort By Created"
                    OnCheck: |-
                        =UpdateContext( { sortByDate: true} )
                    OnFillColor: =RGBA(59, 121, 183, 1)
                    OnText: ="Sort By Date"
                    OnUncheck: |-
                        =UpdateContext( { sortByDate: false} )
                    PaddingBottom: =0
                    PaddingTop: =0
                    PCFTeamsTheme: ="default"
                    Strikethrough: =false
                    Underline: =false
                    Width: =160
                    X: =426
                    Y: =10
                    ZIndex: =2

                s03_btn_Submit As Button:
                    Alignment: ="center"
                    BorderRadius: =0
                    BorderStyle: =""
                    BorderThickness: =0
                    ButtonType: ='Button.ButtonType'.Standard
                    DisplayMode: |-
                        =With({ 
                            valid_selected_items: IfError(CountIf(col_selectedItems, 'Approval Status' = [@'Approval Status'].Draft ),0)
                        },
                        If( valid_selected_items > 0 , DisplayMode.Edit, DisplayMode.Disabled))
                    FillColor: =RGBA(232, 244, 217, 1)
                    Height: =32
                    HideFromAssistiveTechnologies: =false
                    Italic: =false
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    OnSelect: |-
                        =UpdateContext({ multi_submit_mode: true})
                    PaddingBottom: =0
                    PaddingTop: =0
                    PCFTeamsTheme: ="default"
                    Strikethrough: =false
                    Text: |-
                        =With({ 
                            valid_selected_items: IfError(CountIf(col_selectedItems, 'Approval Status' = [@'Approval Status'].Draft ),0)
                        },
                        "Submit" & If( valid_selected_items > 0 , $" ({valid_selected_items})"))
                    Tooltip: ="Submit Expenses"
                    Underline: =false
                    VerticalAlignment: ="middle"
                    Visible: |
                        =true
                    Width: =96
                    X: =646
                    Y: =16
                    ZIndex: =3

                s03_btn_Recall As Button:
                    Alignment: ="center"
                    BorderRadius: =0
                    BorderStyle: =""
                    BorderThickness: =0
                    ButtonType: ='Button.ButtonType'.Standard
                    DisplayMode: |-
                        =With({ 
                            valid_selected_items: IfError(CountIf(col_selectedItems, 'Approval Status' = [@'Approval Status'].Pending ),0)
                        },
                        If( valid_selected_items > 0 , DisplayMode.Edit, DisplayMode.Disabled))
                    FillColor: =RGBA(232, 244, 217, 1)
                    Height: =32
                    HideFromAssistiveTechnologies: =false
                    Italic: =false
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    OnSelect: |-
                        =UpdateContext({ multi_recall_mode: true})
                    PaddingBottom: =0
                    PaddingTop: =0
                    PCFTeamsTheme: ="default"
                    Strikethrough: =false
                    Text: |-
                        =With({ 
                            valid_selected_items: IfError(CountIf(col_selectedItems, 'Approval Status' = [@'Approval Status'].Pending ), 0)
                        },
                        "Recall" & If( valid_selected_items > 0 , $" ({valid_selected_items})"))
                    Tooltip: ="Recall Expenses"
                    Underline: =false
                    VerticalAlignment: ="middle"
                    Visible: |
                        =true
                    Width: =96
                    X: =646
                    Y: =16
                    ZIndex: =4

                s03_btn_Delete As Button:
                    Alignment: ="center"
                    BorderRadius: =0
                    BorderStyle: =""
                    BorderThickness: =0
                    ButtonType: ='Button.ButtonType'.Standard
                    DisplayMode: |-
                        =With({ 
                            valid_selected_items: IfError(CountIf(col_selectedItems, 'Approval Status' = [@'Approval Status'].Draft ),0)
                        },
                        If( valid_selected_items > 0 , DisplayMode.Edit, DisplayMode.Disabled))
                    FillColor: =RGBA(232, 244, 217, 1)
                    Height: =32
                    HideFromAssistiveTechnologies: =false
                    Italic: =false
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    OnSelect: |-
                        =UpdateContext({ multi_delete_mode: true})
                    PaddingBottom: =0
                    PaddingTop: =0
                    PCFTeamsTheme: ="default"
                    Strikethrough: =false
                    Text: |-
                        =With({ 
                            valid_selected_items: IfError(CountIf(col_selectedItems, Or( 'Approval Status' = [@'Approval Status'].Draft, 'Approval Status' = [@'Approval Status'].Pending) ),0)
                        },
                        "Delete" & If( valid_selected_items > 0 , $" ({valid_selected_items})"))
                    Tooltip: ="Delete Expenses"
                    Underline: =false
                    VerticalAlignment: ="middle"
                    Visible: |
                        =true
                    Width: =96
                    X: =646
                    Y: =16
                    ZIndex: =5

                s03_Filler1 As rectangle:
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.None
                    DisabledFill: =Color.Transparent
                    DisplayMode: =DisplayMode.View
                    Fill: =Color.Transparent
                    FillPortions: =1
                    FocusedBorderColor: =RGBA(98, 100, 167, 1)
                    Height: =Parent.Height
                    HoverFill: =Color.Transparent
                    PressedFill: =Color.Transparent
                    ZIndex: =6

                s03_Ico_Reload As icon.Reload:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    Color: =RGBA(98, 100, 167, 1)
                    DisabledBorderColor: =RGBA(243, 242, 241, 1)
                    DisabledColor: =RGBA(220, 220, 220, 1)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    Height: =32
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Reload
                    OnSelect: =Refresh( TSExpenses )
                    PaddingBottom: =3
                    PaddingLeft: =3
                    PaddingRight: =3
                    PaddingTop: =3
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Width: =32
                    ZIndex: =7

            s03_Header As Header:
                DisplayMode: =DisplayMode.Edit
                Height: =50
                Logo: =Soul2
                Title: =$"Expenses - {var_user_name}"
                UserEmail: =User().Email
                UserImage: =User().Image
                UserName: =User().FullName
                Width: =Parent.Width
                X: =0
                Y: =0
                ZIndex: =4

        s03_Divider As rectangle:
            BorderColor: =RGBA(243, 242, 241, 1)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledFill: =RGBA(200, 198, 196, 1)
            Fill: =varStyle.dividerFill
            FocusedBorderColor: =RGBA(98, 100, 167, 1)
            Height: =Parent.Height
            HoverFill: =RGBA(98, 100, 167, 1)
            PressedFill: =RGBA(98, 100, 167, 1)
            Width: =1
            X: =s03_LeftContainer.Width
            ZIndex: =2

        s03_RightContainer As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.Start
            Height: =Parent.Height - varStyle.bottomBarHeight
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =Parent.Height - varStyle.bottomBarHeight
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Width: =340
            X: =1025
            ZIndex: =3

            s03_RightTopbar As groupContainer:
                FillPortions: =0
                Height: =varStyle.topBarHeight
                LayoutMinHeight: =150
                LayoutMinWidth: =250
                Width: =Parent.Width
                ZIndex: =1

                s03_ico_Delete As icon.Trash:
                    AccessibleLabel: =Self.Tooltip
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =varStyle.borderStyle
                    Color: =RGBA(98, 100, 167, 1)
                    DisabledBorderColor: =RGBA(243, 242, 241, 1)
                    DisabledColor: =RGBA(220, 220, 220, 1)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    DisplayMode: |-
                        =Switch( selected_item.'Approval Status', 
                            'Approval Status'.Rejected,DisplayMode.Disabled,
                            'Approval Status'.Approved,DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    FocusedBorderColor: =varStyle.focusBorderColor
                    FocusedBorderThickness: =varStyle.focusBorderThickness
                    Height: =varStyle.largeIconSize
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Trash
                    OnSelect: |-
                        =UpdateContext({delete_mode:true })
                    PaddingBottom: =varStyle.iconPadding
                    PaddingLeft: =varStyle.iconPadding
                    PaddingRight: =varStyle.iconPadding
                    PaddingTop: =varStyle.iconPadding
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =0
                    Tooltip: ="Delete Record"
                    Visible: =And(!edit_mode, !add_mode)
                    Width: =varStyle.largeIconSize
                    X: =s03_ico_Edit.X - varStyle.spaceBetweenIcons - Self.Width
                    Y: =(Parent.Height -  Self.Height) / 2
                    ZIndex: =21

                s03_ico_Edit As icon.Edit:
                    AccessibleLabel: =Self.Tooltip
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =varStyle.borderStyle
                    Color: =RGBA(98, 100, 167, 1)
                    DisabledBorderColor: =RGBA(243, 242, 241, 1)
                    DisabledColor: =RGBA(220, 220, 220, 1)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    DisplayMode: |-
                        =Switch( selected_item.'Approval Status', 
                            'Approval Status'.Rejected,DisplayMode.Disabled,
                            'Approval Status'.Approved,DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    FocusedBorderColor: =varStyle.focusBorderColor
                    FocusedBorderThickness: =varStyle.focusBorderThickness
                    Height: =varStyle.largeIconSize
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Edit
                    OnSelect: |-
                        =UpdateContext({edit_mode:true})
                    PaddingBottom: =varStyle.iconPadding
                    PaddingLeft: =varStyle.iconPadding
                    PaddingRight: =varStyle.iconPadding
                    PaddingTop: =varStyle.iconPadding
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =0
                    Tooltip: ="Edit Record"
                    Visible: =And(!edit_mode, !add_mode)
                    Width: =varStyle.largeIconSize
                    X: =Parent.Width - Self.Width - varStyle.topBarTitleLeftPadding
                    Y: =(Parent.Height -  Self.Height) / 2
                    ZIndex: =22

                s03_ico_Cancel As icon.Cancel:
                    AccessibleLabel: =Self.Tooltip
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =varStyle.borderStyle
                    Color: =RGBA(98, 100, 167, 1)
                    DisabledBorderColor: =RGBA(243, 242, 241, 1)
                    DisabledColor: =RGBA(220, 220, 220, 1)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =varStyle.focusBorderColor
                    FocusedBorderThickness: =varStyle.focusBorderThickness
                    Height: =varStyle.largeIconSize
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Cancel
                    OnSelect: |-
                        =ResetForm(s03_frm_Expense); UpdateContext({edit_mode: false, add_mode: false});
                    PaddingBottom: =varStyle.iconPadding
                    PaddingLeft: =varStyle.iconPadding
                    PaddingRight: =varStyle.iconPadding
                    PaddingTop: =varStyle.iconPadding
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =0
                    Tooltip: ="Cancel"
                    Visible: =Or(edit_mode, add_mode)
                    Width: =varStyle.largeIconSize
                    X: =s03_ico_Accept.X - varStyle.spaceBetweenIcons - Self.Width
                    Y: =(Parent.Height -  Self.Height) / 2
                    ZIndex: =23

                s03_ico_Accept As icon.Check:
                    AccessibleLabel: =Self.Tooltip
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =varStyle.borderStyle
                    Color: =RGBA(98, 100, 167, 1)
                    DisabledBorderColor: =RGBA(243, 242, 241, 1)
                    DisabledColor: =RGBA(220, 220, 220, 1)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    DisplayMode: =If( s03_frm_Expense.Valid, DisplayMode.Edit, DisplayMode.Disabled)
                    FocusedBorderColor: =varStyle.focusBorderColor
                    FocusedBorderThickness: =varStyle.focusBorderThickness
                    Height: =varStyle.largeIconSize
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Check
                    OnSelect: |-
                        =SubmitForm(s03_frm_Expense);
                        UpdateContext({
                            selected_item: Blank(),
                            edit_mode: false, 
                            add_mode: false});
                        Reset(s03_gal_Timesheet)
                    PaddingBottom: =varStyle.iconPadding
                    PaddingLeft: =varStyle.iconPadding
                    PaddingRight: =varStyle.iconPadding
                    PaddingTop: =varStyle.iconPadding
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =0
                    Tooltip: ="Save record"
                    Visible: =Or(edit_mode, add_mode)
                    Width: =varStyle.largeIconSize
                    X: =Parent.Width - Self.Width - varStyle.topBarTitleLeftPadding
                    Y: =(Parent.Height -  Self.Height) / 2
                    ZIndex: =24

                s03_ico_Recall As icon.Trash:
                    AccessibleLabel: =Self.Tooltip
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =varStyle.borderStyle
                    Color: =RGBA(98, 100, 167, 1)
                    DisabledBorderColor: =RGBA(243, 242, 241, 1)
                    DisabledColor: =RGBA(220, 220, 220, 1)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    DisplayMode: =If( selected_item.'Approval Status' = 'Approval Status'.Pending, DisplayMode.Edit, DisplayMode.Disabled )
                    FocusedBorderColor: =varStyle.focusBorderColor
                    FocusedBorderThickness: =varStyle.focusBorderThickness
                    Height: =varStyle.largeIconSize
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Reset
                    OnSelect: |-
                        =UpdateContext({recall_mode:true })
                    PaddingBottom: =varStyle.iconPadding
                    PaddingLeft: =varStyle.iconPadding
                    PaddingRight: =varStyle.iconPadding
                    PaddingTop: =varStyle.iconPadding
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =0
                    Tooltip: ="Recall Expense"
                    Visible: =Not( Or(edit_mode, add_mode) )
                    Width: =varStyle.largeIconSize
                    X: =s03_ico_Delete.X - varStyle.spaceBetweenIcons - Self.Width
                    Y: =(Parent.Height -  Self.Height) / 2
                    ZIndex: =25

                s03_ico_Add As icon.Trash:
                    AccessibleLabel: =Self.Tooltip
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =varStyle.borderStyle
                    Color: =RGBA(98, 100, 167, 1)
                    DisabledBorderColor: =RGBA(243, 242, 241, 1)
                    DisabledColor: =RGBA(220, 220, 220, 1)
                    DisabledFill: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =varStyle.focusBorderColor
                    FocusedBorderThickness: =varStyle.focusBorderThickness
                    Height: =varStyle.largeIconSize
                    HoverBorderColor: =RGBA(0, 0, 0, 0)
                    HoverColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    Icon: =Icon.Add
                    OnSelect: |-
                        =UpdateContext({add_mode:true })
                    PaddingBottom: =varStyle.iconPadding
                    PaddingLeft: =varStyle.iconPadding
                    PaddingRight: =varStyle.iconPadding
                    PaddingTop: =varStyle.iconPadding
                    PressedBorderColor: =RGBA(0, 0, 0, 0)
                    PressedColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    TabIndex: =0
                    Tooltip: ="Delete"
                    Visible: =!edit_mode
                    Width: =varStyle.largeIconSize
                    Y: =(Parent.Height -  Self.Height) / 2
                    ZIndex: =27

            s03_Divider1 As rectangle:
                BorderColor: =RGBA(243, 242, 241, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledFill: =RGBA(200, 198, 196, 1)
                Fill: =varStyle.dividerFill
                FocusedBorderColor: =RGBA(98, 100, 167, 1)
                Height: =1
                HoverFill: =RGBA(98, 100, 167, 1)
                PressedFill: =RGBA(98, 100, 167, 1)
                Width: =Parent.Width
                Y: =s03_RightTopbar.Height
                ZIndex: =2

            s03_frm_Expense As form:
                AcceptsFocus: =false
                BorderColor: =RGBA(243, 242, 241, 1)
                DataSource: =TSExpenses
                DefaultMode: |
                    =If(edit_mode, FormMode.Edit, If( add_mode, FormMode.New, FormMode.View))
                Item: =selected_item
                LayoutMinHeight: =250
                LayoutMinWidth: =Parent.Width
                NumberOfColumns: =1
                OnSuccess: =
                ZIndex: =3

                Project_DataCard1 As typedDataCard.pcfCoreComboBoxEditCard:
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_Project"
                    Default: =ThisItem.Project
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@TSExpenses],DataSourceInfo.DisplayName,"soul_Project")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    Required: =true
                    Update: =s03_card_Project.Selected
                    Width: =341
                    WidthFit: =true
                    X: =0
                    Y: =0
                    ZIndex: =1

                    DataCardKey4 As Label:
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =10.5
                        Height: =22
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =1
                        ZIndex: =1

                    s03_card_Project As combobox:
                        AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                        BorderColor: =RGBA(243, 242, 241, 1)
                        ChevronBackground: =RGBA(243, 242, 241, 1)
                        ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                        ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                        ChevronFill: =RGBA(96, 94, 92, 1)
                        ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                        ChevronHoverFill: =RGBA(96, 94, 92, 1)
                        Color: =RGBA(37, 36, 35, 1)
                        DefaultSelectedItems: =Parent.Default
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(200, 198, 196, 1)
                        DisabledFill: =RGBA(243, 242, 241, 1)
                        DisplayFields: =["soul_name"]
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(243, 242, 241, 1)
                        FocusedBorderColor: =RGBA(98, 100, 167, 1)
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                        HoverColor: =RGBA(37, 36, 35, 1)
                        HoverFill: =RGBA(243, 242, 241, 1)
                        Items: =Choices([@TSExpenses].soul_Project)
                        PaddingLeft: =12
                        PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(243, 242, 241, 1)
                        SearchFields: =["soul_name"]
                        SearchItems: =Search(Choices([@TSExpenses].soul_Project),s03_card_Project.SearchText,"soul_name")
                        SelectionColor: =RGBA(37, 36, 35, 1)
                        SelectionFill: =RGBA(237, 235, 233, 1)
                        SelectMultiple: =false
                        Size: =10.5
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey4.Y + DataCardKey4.Height + 4
                        ZIndex: =2

                    ErrorMessage3 As Label:
                        AutoHeight: =false
                        Color: =Color.Red
                        DisplayMode: =DisplayMode.View
                        FontSize: =9
                        Height: =25
                        Overflow: ='Label.Overflow'.Hidden
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =false
                        X: =24
                        Y: =s03_card_Project.Y + s03_card_Project.Height
                        ZIndex: =3

                    StarVisible3 As Label:
                        Alignment: =Align.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =20
                        Text: ="*"
                        VerticalAlignment: =VerticalAlign.Bottom
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey4.Y
                        ZIndex: =4

                Reason_DataCard1 As typedDataCard.pcfCoreComboBoxOptionSetSingleEditCard:
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_reason"
                    Default: =ThisItem.Reason
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@TSExpenses],DataSourceInfo.DisplayName,"soul_reason")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    Required: =true
                    Update: =DataCardValue5.Selected.Value
                    Width: =341
                    WidthFit: =true
                    X: =0
                    Y: =2
                    ZIndex: =1

                    DataCardKey2 As Label:
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =22
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =10
                        ZIndex: =1

                    DataCardValue5 As combobox:
                        AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                        BorderColor: =RGBA(243, 242, 241, 1)
                        ChevronBackground: =RGBA(243, 242, 241, 1)
                        ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                        ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                        ChevronFill: =RGBA(96, 94, 92, 1)
                        ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                        ChevronHoverFill: =RGBA(96, 94, 92, 1)
                        Color: =RGBA(37, 36, 35, 1)
                        DefaultSelectedItems: =[Parent.Default]
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(200, 198, 196, 1)
                        DisabledFill: =RGBA(243, 242, 241, 1)
                        DisplayFields: =["Value"]
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(243, 242, 241, 1)
                        FocusedBorderColor: =RGBA(98, 100, 167, 1)
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                        HoverColor: =RGBA(37, 36, 35, 1)
                        HoverFill: =RGBA(243, 242, 241, 1)
                        IsSearchable: =false
                        Items: =Choices('Reason (TSExpenses)')
                        PaddingLeft: =12
                        PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(243, 242, 241, 1)
                        SearchFields: =["Value"]
                        SearchItems: =[]
                        SelectionColor: =RGBA(37, 36, 35, 1)
                        SelectionFill: =RGBA(237, 235, 233, 1)
                        SelectMultiple: =false
                        Size: =10.5
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey2.Y + DataCardKey2.Height + 4
                        ZIndex: =2

                    ErrorMessage5 As Label:
                        AutoHeight: =true
                        Color: =Color.Red
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =30
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValue5.Y + DataCardValue5.Height
                        ZIndex: =3

                    StarVisible5 As Label:
                        Alignment: =Align.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =20
                        Text: ="*"
                        VerticalAlignment: =VerticalAlign.Bottom
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey2.Y
                        ZIndex: =4

                Amount_DataCard1 As typedDataCard.pcfCoreCurrencyEditCard:
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_amount"
                    Default: =ThisItem.Amount
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@TSExpenses],DataSourceInfo.DisplayName,"soul_amount")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    Required: =true
                    Update: =Value(DataCardValue1.Text)
                    Width: =341
                    WidthFit: =true
                    X: =0
                    Y: =3
                    ZIndex: =1

                    DataCardKey1 As Label:
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =10.5
                        Height: =22
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =10
                        ZIndex: =1

                    DataCardValue1 As text:
                        AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                        BorderColor: =RGBA(243, 242, 241, 1)
                        BorderThickness: =0
                        Color: =RGBA(37, 36, 35, 1)
                        Default: =Parent.Default
                        DelayOutput: =true
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(200, 198, 196, 1)
                        DisabledFill: =RGBA(243, 242, 241, 1)
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(243, 242, 241, 1)
                        FocusedBorderColor: =RGBA(98, 100, 167, 1)
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Format: =TextFormat.Number
                        Height: =32
                        HoverBorderColor: =RGBA(243, 242, 241, 1)
                        HoverColor: =RGBA(37, 36, 35, 1)
                        HoverFill: =RGBA(243, 242, 241, 1)
                        PaddingBottom: =4
                        PaddingRight: =12
                        PaddingTop: =0
                        PressedBorderColor: =RGBA(98, 100, 167, 1)
                        PressedColor: =RGBA(37, 36, 35, 1)
                        PressedFill: =RGBA(243, 242, 241, 1)
                        RadiusBottomLeft: =3
                        RadiusBottomRight: =3
                        RadiusTopLeft: =3
                        RadiusTopRight: =3
                        Size: =10.5
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey1.Y + DataCardKey1.Height + 4
                        ZIndex: =2

                    ErrorMessage1 As Label:
                        AutoHeight: =true
                        Color: =Color.Red
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =30
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValue1.Y + DataCardValue1.Height
                        ZIndex: =3

                    StarVisible1 As Label:
                        Alignment: =Align.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =30
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey1.Y
                        ZIndex: =4

                Receipt_DataCard1 As typedDataCard.fileEditCard:
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_receipt"
                    Default: |-
                        =If(!IsBlank(ThisItem.Receipt.FileName), Table({DisplayName: ThisItem.Receipt.FileName, Value: ThisItem.Receipt.Value}), Blank())
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@TSExpenses],DataSourceInfo.DisplayName,"soul_receipt")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =174
                    Required: =true
                    Update: =s03_Card_Attachments.Attachments
                    Width: =341
                    X: =0
                    Y: =4
                    ZIndex: =1

                    DataCardKey7 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(37, 36, 35, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(200, 198, 196, 1)
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =34
                        PaddingLeft: =0
                        Size: =10.5
                        Text: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        Wrap: =false
                        X: =30
                        Y: =10
                        ZIndex: =1

                    s03_Card_Attachments As attachments:
                        AddAttachmentText: ="Upload file"
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(37, 36, 35, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(200, 198, 196, 1)
                        DisabledFill: =RGBA(243, 242, 241, 1)
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(243, 242, 241, 1)
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =Parent.Height * 0.70
                        HoverColor: =RGBA(37, 36, 35, 1)
                        HoverFill: =RGBA(243, 242, 241, 1)
                        IsInDataCard: =true
                        ItemColor: =RGBA(0, 0, 0, 1)
                        ItemFill: =RGBA(237, 235, 233, 1)
                        ItemHoverColor: =RGBA(37, 36, 35, 1)
                        ItemHoverFill: =RGBA(243, 242, 241, 1)
                        Items: =Parent.Default
                        ItemSpacing: =12
                        MaxAttachments: =2
                        MaxAttachmentSize: =32
                        MaxAttachmentsText: =""
                        NoAttachmentsColor: =RGBA(200, 198, 196, 1)
                        NoAttachmentsText: ="There is no file."
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(237, 235, 233, 1)
                        Size: =10.5
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardKey7.Y + DataCardKey7.Height + 5
                        ZIndex: =2

                    ErrorMessage7 As label:
                        AutoHeight: =true
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(168, 0, 0, 1)
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =10.5
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =s03_Card_Attachments.Y + s03_Card_Attachments.Height
                        ZIndex: =3

                    StarVisible7 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(37, 36, 35, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(200, 198, 196, 1)
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =DataCardKey7.Height
                        PaddingLeft: =0
                        Size: =10.5
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey7.Y
                        ZIndex: =4

                Note_DataCard1 As typedDataCard.pcfCoreTextualMultiLineEditCard:
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_note"
                    Default: =ThisItem.Note
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@TSExpenses],DataSourceInfo.DisplayName,"soul_note")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =160
                    Required: =false
                    Update: =DataCardValue2.Value
                    Width: =341
                    WidthFit: =true
                    X: =0
                    Y: =5
                    ZIndex: =1

                    DataCardKey3 As Label:
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =22
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =10
                        ZIndex: =1

                    "DataCardValue2 As 'Text box'":
                        AccessibleLabel: =Parent.DisplayName
                        DisplayMode: =Parent.DisplayMode
                        FontSize: =10.5
                        Height: =Parent.Height * 0.75
                        Mode: ="Multiline"
                        Required: =Parent.Required
                        Tooltip: =Parent.DisplayName
                        Value: =Parent.Default
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey3.Y + DataCardKey3.Height + 4
                        ZIndex: =2

                    ErrorMessage2 As Label:
                        AutoHeight: =true
                        Color: =Color.Red
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =30
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValue2.Y + DataCardValue2.Height
                        ZIndex: =3

                    StarVisible2 As Label:
                        Alignment: =Align.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =30
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey3.Y
                        ZIndex: =4

                "'Approval Status_DataCard1' As typedDataCard.pcfCoreComboBoxOptionSetSingleEditCard":
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_approvalstatus"
                    Default: =Coalesce(ThisItem.'Approval Status', 'Approval Status'.Draft)
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@TSExpenses],DataSourceInfo.DisplayName,"soul_approvalstatus")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    Required: =true
                    Update: =DataCardValue4.Selected.Value
                    Width: =341
                    WidthFit: =true
                    X: =0
                    Y: =6
                    ZIndex: =1

                    DataCardKey5 As Label:
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =22
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =10
                        ZIndex: =1

                    DataCardValue4 As combobox:
                        AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                        BorderColor: =RGBA(243, 242, 241, 1)
                        ChevronBackground: =RGBA(243, 242, 241, 1)
                        ChevronDisabledBackground: =RGBA(243, 242, 241, 1)
                        ChevronDisabledFill: =RGBA(200, 198, 196, 1)
                        ChevronFill: =RGBA(96, 94, 92, 1)
                        ChevronHoverBackground: =RGBA(243, 242, 241, 1)
                        ChevronHoverFill: =RGBA(96, 94, 92, 1)
                        Color: =RGBA(37, 36, 35, 1)
                        DefaultSelectedItems: =[Parent.Default]
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(200, 198, 196, 1)
                        DisabledFill: =RGBA(243, 242, 241, 1)
                        DisplayFields: =["Value"]
                        DisplayMode: |-
                            =//Parent.DisplayMode
                            DisplayMode.View
                        Fill: =RGBA(243, 242, 241, 1)
                        FocusedBorderColor: =RGBA(98, 100, 167, 1)
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                        HoverColor: =RGBA(37, 36, 35, 1)
                        HoverFill: =RGBA(243, 242, 241, 1)
                        IsSearchable: =false
                        Items: =Choices('Approval Status')
                        PaddingLeft: =12
                        PressedBorderColor: =ColorFade(RGBA(98, 100, 167, 1), -30%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =RGBA(243, 242, 241, 1)
                        SearchFields: =["Value"]
                        SearchItems: =[]
                        SelectionColor: =RGBA(37, 36, 35, 1)
                        SelectionFill: =RGBA(237, 235, 233, 1)
                        SelectMultiple: =false
                        Size: =10.5
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey5.Y + DataCardKey5.Height + 4
                        ZIndex: =2

                    ErrorMessage4 As Label:
                        AutoHeight: =true
                        Color: =Color.Red
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =30
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValue4.Y + DataCardValue4.Height
                        ZIndex: =3

                    StarVisible4 As Label:
                        Alignment: =Align.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =20
                        Text: ="*"
                        VerticalAlignment: =VerticalAlign.Bottom
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey5.Y
                        ZIndex: =4

                "'Resource Email_DataCard1' As typedDataCard.pcfCoreTextualEditCard":
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_resourcemail"
                    Default: |-
                        =// ThisItem.'Resource Email'
                        User().Email
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@TSExpenses],DataSourceInfo.DisplayName,"soul_resourcemail")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    MaxLength: =DataSourceInfo([@TSExpenses], DataSourceInfo.MaxLength, "soul_resourcemail")
                    Required: =true
                    Update: =DataCardValue6.Value
                    Width: =341
                    WidthFit: =true
                    X: =0
                    Y: =7
                    ZIndex: =1

                    DataCardKey6 As Label:
                        AutoHeight: =true
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =22
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =10
                        ZIndex: =1

                    "DataCardValue6 As 'Text box'":
                        AccessibleLabel: =Parent.DisplayName
                        DisplayMode: |-
                            =// Parent.DisplayMode
                            DisplayMode.View
                        FontSize: =10.5
                        Height: =32
                        Mode: ="SingleLine"
                        Required: =Parent.Required
                        Tooltip: =Parent.DisplayName
                        Value: =Parent.Default
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =DataCardKey6.Y + DataCardKey6.Height + 4
                        ZIndex: =2

                    ErrorMessage6 As Label:
                        AutoHeight: =true
                        Color: =Color.Red
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =9
                        Height: =30
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =true
                        X: =24
                        Y: =DataCardValue6.Y + DataCardValue6.Height
                        ZIndex: =3

                    StarVisible6 As Label:
                        Alignment: =Align.Center
                        DisplayMode: =DisplayMode.Edit
                        Height: =30
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey6.Y
                        ZIndex: =4

                "'Date of Interest _DataCard2' As typedDataCard.pcfCoreDateTimeEditCard":
                    BorderColor: =RGBA(243, 242, 241, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="soul_dateofinterest"
                    Default: =ThisItem.'Date of Interest'
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Date of Interest"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =70
                    Required: =true
                    Update: =Date(Year(DateValue2.Value), Month(DateValue2.Value), Day(DateValue2.Value)) + Value(Second(DateValue2.Value))
                    Width: =341
                    WidthFit: =true
                    X: =0
                    Y: =1
                    ZIndex: =4

                    DataCardKey12 As Label:
                        AutoHeight: =false
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =10.5
                        Height: =22
                        Overflow: ="Hidden"
                        PaddingBottom: =0
                        PaddingTop: =0
                        Text: =Parent.DisplayName
                        Tooltip: =Parent.DisplayName
                        VerticalAlignment: =VerticalAlign.Bottom
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =10
                        ZIndex: =1

                    "DateValue2 As 'Date picker'":
                        AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                        DisplayMode: =Parent.DisplayMode
                        FontWeight: ="normal"
                        Height: =32
                        IconSize: =16
                        PaddingBottom: =0
                        PaddingTop: =0
                        Tooltip: =Parent.DisplayName
                        Value: =Parent.Default
                        Width: =(Parent.Width - 48) / 2
                        X: =24
                        Y: =DataCardKey12.Y + DataCardKey12.Height + 4
                        ZIndex: =2

                    Separator2 As Label:
                        Alignment: =Align.Center
                        AutoHeight: =false
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =10.5
                        Height: |
                            =0
                        Overflow: ="Hidden"
                        PaddingBottom: =0
                        PaddingTop: =0
                        Text: |-
                            =":"
                        VerticalAlignment: =VerticalAlign.Middle
                        Width: =10
                        X: |
                            =0
                        Y: |
                            =0
                        ZIndex: =4

                    ErrorMessage12 As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =Color.Red
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(200, 198, 196, 1)
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =30
                        Live: =Live.Assertive
                        Size: =9
                        Text: =Parent.Error
                        Tooltip: =Parent.Error
                        Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                        Width: =Parent.Width - 48
                        Wrap: =false
                        X: =24
                        Y: =DateValue2.Y + DateValue2.Height
                        ZIndex: =6

                    StarVisible12 As Label:
                        Alignment: =Align.Center
                        AutoHeight: =false
                        DisplayMode: =DisplayMode.Edit
                        Height: =20
                        Overflow: ="Hidden"
                        PaddingBottom: =0
                        PaddingTop: =0
                        Text: ="*"
                        VerticalAlignment: =VerticalAlign.Bottom
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        X: =0
                        Y: =DataCardKey12.Y
                        ZIndex: =7

    s03_DeleteConfirmOverlay As CConfirmOverlay:
        Fill: =RGBA(253, 222, 207, 1)
        Height: =Parent.Height - s03_BottomBar.Height
        OnCancel: |-
            =UpdateContext({delete_mode:false})
        OnConfirm: |
            =IfError(
                Remove( TSExpenses, selected_item),
                // ERROR
                false,
                // SUCCESS
                UpdateContext({ 
                    selected_item: Blank(),
                    delete_mode: false
                })
            )
        Visible: =delete_mode
        Width: =s03_frm_Expense.Width
        X: =Parent.Width - Self.Width
        ZIndex: =2

    s03_RecallConfirmOverlay As CConfirmOverlay:
        ConfirmText: ="Recall"
        Fill: =RGBA(244, 244, 243, 1)
        Height: =Parent.Height
        OnCancel: |-
            =UpdateContext({recall_mode:false})
        OnConfirm: |
            =Patch( TSExpenses, selected_item, { 'Approval Status': 'Approval Status'.Draft });
            If(
                IsEmpty( Errors(TSExpenses, selected_item) ),
                UpdateContext({ 
                    selected_item: Blank(),
                    recall_mode: false
                })
            );
        PromptText: ="Are you sure you want to Recall this record ?"
        Visible: =recall_mode
        Width: =s03_frm_Expense.Width
        X: =Parent.Width - Self.Width
        ZIndex: =3

    s03_MultiDeleteOverlay As CConfirmOverlay:
        ConfirmText: ="Delete"
        Fill: =RGBA(253, 222, 207, 1)
        Height: =Parent.Height - s03_BottomBar.Height
        OnCancel: |-
            =UpdateContext({ multi_delete_mode:false })
        OnConfirm: |-
            =With({ 
                valid_selected_items: Filter(col_selectedItems, Or( 'Approval Status' = [@'Approval Status'].Draft, 'Approval Status' = [@'Approval Status'].Pending) )
            },
            ForAll( valid_selected_items, 
                Remove( TSExpenses, ThisRecord ); 
                RemoveIf( col_selectedItems, TSExpense = ThisRecord.TSExpense )
            ));
            UpdateContext({ multi_delete_mode:false })
        PromptText: ="Are you sure you want to Delete these records ?"
        Visible: =multi_delete_mode
        Width: =s03_frm_Expense.Width
        X: =Parent.Width - Self.Width
        ZIndex: =4

    s03_MultiRecallOverlay As CConfirmOverlay:
        ConfirmText: ="Recall"
        Fill: =RGBA(244, 244, 243, 1)
        Height: =Parent.Height
        OnCancel: |-
            =UpdateContext({ multi_recall_mode:false })
        OnConfirm: |-
            =With({ 
                valid_selected_items: Filter(col_selectedItems, 'Approval Status' = [@'Approval Status'].Pending )
            },
            ForAll( valid_selected_items, 
                IfError( Patch(TSExpenses, ThisRecord, { 
                    'Approval Status': [@'Approval Status'].Draft, 
                    Status: 'Status (TSExpenses)'.Inactive 
                    }), 
                false,
                RemoveIf( col_selectedItems, TSExpense = ThisRecord.TSExpense ))
            ));
            UpdateContext({ multi_recall_mode:false })
        PromptText: ="Are you sure you want to Recall these records ?"
        Visible: =multi_recall_mode
        Width: =s03_frm_Expense.Width
        X: =Parent.Width - Self.Width
        ZIndex: =5

    s03_MultiSubmitOverlay As CConfirmOverlay:
        ConfirmText: ="Submit"
        Fill: =RGBA(244, 244, 243, 1)
        Height: =Parent.Height - s03_BottomBar.Height
        OnCancel: |-
            =UpdateContext({ multi_submit_mode:false })
        OnConfirm: |-
            =With({ 
                valid_selected_items: Filter(col_selectedItems, 'Approval Status' = [@'Approval Status'].Draft )
            },
            ForAll( valid_selected_items, 
                IfError( Patch(TSExpenses, ThisRecord, { 'Approval Status': [@'Approval Status'].Pending }), 
                    false,
                    RemoveIf( col_selectedItems, TSExpense = ThisRecord.TSExpense ))
            ));
            UpdateContext({ multi_submit_mode:false })
        PromptText: ="Are you sure you want to Submit these records ?"
        Visible: =multi_submit_mode
        Width: =s03_frm_Expense.Width
        X: =Parent.Width - Self.Width
        ZIndex: =6

    s03_BottomBar As BottomBar:
        Height: =varStyle.bottomBarHeight
        Version: =var_current_version
        Width: =Parent.Width
        Y: =Parent.Height - Self.Height
        ZIndex: =7

    CommonUtils As CCommonUtils:
        GetWeekDayText: =Switch(Weekday( Date ), 1, "Sun", 2, "Mon", 3, "Tue", 4, "Wed", 5, "Thu", 6, "Fri", 7, "Sat") 
        Height: =5
        Width: =5
        ZIndex: =8

